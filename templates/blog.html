{% extends "section.html" %}
{% import "macros.html" as macros %}

{% block seccontent %}
{% for post in section.pages %}
  {% set this_year = post.date | date(format="%Y") %}
  {% if post.earlier.date %}
    {% set pre_year = post.earlier.date | date(format="%Y") %}
  {% endif %}

  {% if loop.first %}
    <h2 class="text-right">{{this_year}}</h2>
    <nav class="posts">
  {% endif %}

    <div class="posts-item">
      <time class="post-date" datetime="{{ post.date | date(format="%Y-%m-%dT%H:%M:%S") }}">
          {{ post.date | date(format="%B %d") }}
            Â· {{ macros::read_time(words=post.word_count) }}
      </time>
      <h3><a href="{{ post.permalink }}">{{ post.title }}</a></h3>
      {% if post.extra.image %}
        {{ post.extra.image }}
      {% else %}
        {{ post.summary | safe }}
      {% endif %}
    </div>

  {% if loop.last %}
    </nav>
  {% else %}
    {% if this_year != pre_year %}
      </nav>
      <h2 class="text-right">{{pre_year}}</h2>
      <nav class="posts">
    {% endif %}
  {% endif %}
{% endfor %}
{% endblock seccontent %}
